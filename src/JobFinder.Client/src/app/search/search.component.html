<p *ngIf="!showTabs && !isLoading" style="text-align: center; margin: 15px 10px; font-size: small;">پلتفرم ما به شما کمک می‌کند به‌جای
  جستجو در سایت‌های مختلف، همه آگهی‌های استخدامی را در یکجا ببینید. با ابزار جستجوی
  هوشمند ما می‌توانید در وقت خود صرفه‌جویی کنید و سریع‌تر فرصت‌های شغلی مناسب را پیدا کنید.</p>

<div class="search-container">
  <input pInputText type="text" placeholder="..." [(ngModel)]="query" />
  <p-button [disabled]="isLoading" label="جستجو" severity="primary" (onClick)="getAds()" />
</div>

<div class="source-selection">
  <div class="flex items-center" *ngFor="let item of sources">
    <p-checkbox size="small" [binary]="true" [(ngModel)]="item.isEnabled" />
    <label class="ml-2">{{ item.titleFa }}</label>
  </div>
</div>

<p-tabs *ngIf="showTabs" [value]="activeTab">
  <p-tablist>
    @for (item of sourcesSnapshot; track item.title) {
    <p-tab [value]="item.title" hidden="{{ !item.isEnabled }}">{{
      item.titleFa
      }}</p-tab>
    }
  </p-tablist>
  <p-tabpanels>
    @for (item of sourcesSnapshot; track item.title) {
    <p-tabpanel [value]="item.title">
      @for (ad of item.ads; track ad.title) {
      <p-card>
        <div class="card-content">
          <div class="card-image">
            <img src="{{ ad.logoUrl }}" alt="" />
          </div>
          <div class="card-details">
            <p style="font-weight: bold">{{ ad.title }}</p>
            <p>{{ ad.company ?? "-" }}</p>
            <p>{{ ad.location ?? "-" }}</p>
            <p style="font-size: small">{{ ad.dateIdentifier }}</p>
          </div>
          <div class="card-actions">
            <p-button size="small" icon="{{ ad.bookmarked ? 'pi pi-bookmark-fill' : 'pi pi-bookmark' }}"
              [rounded]="true" [text]="true" severity="secondary" (onClick)="bookmarkAd(ad)" />
            <p-button size="small" icon="pi pi-info-circle" [rounded]="true" [text]="true" severity="info"
              (click)="showModal(item.title, ad.title, ad.url)" />
            <a size="small" pButton [href]="ad.url" icon="pi pi-external-link" class="p-button-rounded p-button-text"
              target="_blank">
            </a>
          </div>
        </div>
      </p-card>
      }
      <div *ngIf="!isLoading" style="width: 100%; text-align: center; margin-top: 10px">
        <p-button (onClick)="loadMore(item.title, query)" label="نمایش موارد بیشتر" variant="text" severity="secondary"
          size="small" />
      </div>
    </p-tabpanel>
    }
  </p-tabpanels>
</p-tabs>

<p-dialog header="{{ modalTitle }}" [modal]="true" [(visible)]="modalVisible" [style]="{ width: '50rem' }"
  [breakpoints]="{ '1199px': '75vw', '575px': '90vw' }">
  <div class="loadingIndicator">
    <p-progress-spinner *ngIf="modalIsLoading" strokeWidth="8" fill="transparent" animationDuration=".5s"
      [style]="{ width: '50px', height: '50px' }" />
  </div>
  <div [innerHTML]="modalContent"></div>
</p-dialog>

<div class="loadingIndicator">
  <p-progress-spinner *ngIf="isLoading" strokeWidth="8" fill="transparent" animationDuration=".5s"
    [style]="{ width: '50px', height: '50px' }" />
</div>